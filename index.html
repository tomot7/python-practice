<!DOCTYPE html>
<html lang="ja">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Pythonデータ処理課題集</title>
    <script src="https://cdn.tailwindcss.com"></script>
    <style>
        /* Interフォントの読み込み */
        @import url('https://fonts.googleapis.com/css2?family=Inter:wght@400;500;600;700&family=Noto+Sans+JP:wght@400;500;700&display=swap');
        body {
            font-family: 'Inter', 'Noto Sans JP', sans-serif;
            display: flex;
            min-height: 100vh;
            background-color: #f3f4f6; /* bg-gray-100 */
        }
        #sidebar {
            width: 256px; /* w-64 */
            background-color: #1f2937; /* bg-gray-800 */
            color: white;
            padding: 1.5rem; /* p-6 */
            position: fixed;
            height: 100%;
            overflow-y: auto;
            transition: transform 0.3s ease-in-out;
            z-index: 40;
        }
        #sidebar.hidden-sidebar {
            transform: translateX(-100%);
        }
        #content {
            flex: 1;
            padding: 1.5rem; /* p-6 */
            margin-left: 256px; /* ml-64 for when sidebar is visible */
            transition: margin-left 0.3s ease-in-out;
        }
        #content.full-width {
            margin-left: 0;
        }
        .sidebar-link {
            display: block;
            padding: 0.75rem 1rem; /* py-3 px-4 */
            border-radius: 0.375rem; /* rounded-md */
            transition: background-color 0.2s;
            cursor: pointer;
            margin-bottom: 0.5rem; /* mb-2 */
        }
        .sidebar-link:hover, .sidebar-link.active {
            background-color: #374151; /* bg-gray-700 */
        }
        .code-block {
            background-color: #111827; /* bg-gray-900 */
            color: #d1d5db; /* text-gray-300 */
            padding: 1rem; /* p-4 */
            border-radius: 0.375rem; /* rounded-md */
            overflow-x: auto;
            font-family: 'Menlo', 'Consolas', monospace;
            font-size: 0.875rem; /* text-sm */
            line-height: 1.25rem; /* leading-5 */
        }
        .hint-block {
            background-color: #eef2ff; /* bg-indigo-50 */
            color: #3730a3; /* text-indigo-800 */
            padding: 1rem; /* p-4 */
            border-radius: 0.375rem; /* rounded-md */
            border-left: 4px solid #4f46e5; /* border-indigo-500 */
            margin-top: 0.5rem; /* mt-2 */
        }
        .hint-block p {
            margin-bottom: 0.5rem; /* mb-2 */
        }
        .hint-block code {
            background-color: #e0e7ff; /* bg-indigo-200 */
            padding: 0.125rem 0.25rem; /* px-1 py-0.5 */
            border-radius: 0.25rem; /* rounded-sm */
            font-weight: 500;
        }
        .card {
            background-color: white;
            border-radius: 0.5rem; /* rounded-lg */
            box-shadow: 0 4px 6px -1px rgba(0, 0, 0, 0.1), 0 2px 4px -1px rgba(0, 0, 0, 0.06); /* shadow-lg */
            padding: 1.5rem; /* p-6 */
            margin-bottom: 1.5rem; /* mb-6 */
        }
        /* Mobile toggle button */
        #menu-toggle {
            position: fixed;
            top: 1rem;
            left: 1rem;
            z-index: 50;
            background-color: #1f2937; /* bg-gray-800 */
            color: white;
            padding: 0.5rem; /* p-2 */
            border-radius: 0.375rem; /* rounded-md */
        }
        @media (min-width: 768px) { /* md breakpoint */
            #menu-toggle {
                display: none;
            }
        }
        @media (max-width: 767px) { /* below md breakpoint */
            #sidebar {
                transform: translateX(-100%);
            }
            #sidebar.active-sidebar {
                transform: translateX(0);
            }
            #content {
                margin-left: 0;
            }
        }
    </style>
</head>
<body>

    <button id="menu-toggle" class="md:hidden">
        <svg xmlns="http://www.w3.org/2000/svg" class="h-6 w-6" fill="none" viewBox="0 0 24 24" stroke="currentColor">
            <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M4 6h16M4 12h16M4 18h16" />
        </svg>
    </button>

    <aside id="sidebar">
        <h1 class="text-2xl font-bold mb-8 text-slate-100">Python課題集</h1>
        <nav id="sidebar-nav">
            </nav>
    </aside>

    <main id="content" class="transition-all duration-300 ease-in-out">
        <div id="exercise-content" class="max-w-4xl mx-auto">
            </div>
    </main>

<script>
const exercises = [
    {
      id: 'kadai1',
      title: '課題1：NumPyで数値計算をしよう 🔢',
      library: 'NumPy (ナムパイ)',
      description: 'NumPyは、数字のリスト（配列と言います）を扱うのが得意なライブラリです。たくさんの数字を一度に計算するときに便利です。',
      task_title: '課題：',
      task: '学生たちのテストの点数があります。これらの点数を使って、以下の計算をしてください。\n1. 全員の点数の合計\n2. 平均点\n3. 一番高い点数\n4. 一番低い点数',
      data_description: 'データ：',
      data: '`[65, 78, 85, 92, 73, 88, 95, 60, 79, 81]`',
      code_hint_title: 'ヒント：使うかもしれないNumPyの関数',
      code_hint_text: `
        <p>NumPy配列を作るには: <code>np.array()</code></p>
        <p>合計を求めるには: <code>np.sum()</code></p>
        <p>平均を求めるには: <code>np.mean()</code></p>
        <p>最大値を見つけるには: <code>np.max()</code></p>
        <p>最小値を見つけるには: <code>np.min()</code></p>
        <p>まずは、PythonのリストをNumPyの配列に変換してみましょう。</p>
      `
    },
    {
      id: 'kadai2',
      title: '課題2：Pandasでデータ整理をしよう 🐼📊',
      library: 'Pandas (パンダス)',
      description: 'Pandasは、表のようなデータ（エクセルのシートみたいなものです）を扱うのがとても上手なライブラリです。データの読み込み、整理、分析が簡単にできます。',
      task_title: '課題：',
      task: '簡単な果物のリストと、それぞれの値段、在庫数があります。このデータをPandasのDataFrameという表の形にして、以下の操作をしてください。\n1. 「在庫数」が10個より多い果物だけを表示する。\n2. 「値段」が一番高い果物の名前を表示する。',
      data_description: 'データ（Pythonの辞書形式）：',
      data_code_lang: 'python',
      data: `
data = {
    "果物": ["りんご", "みかん", "バナナ", "ぶどう", "もも"],
    "値段": [150, 80, 100, 300, 250],
    "在庫数": [20, 15, 5, 12, 8]
}`,
      code_hint_title: 'ヒント：使うかもしれないPandasの機能',
      code_hint_text: `
        <p>Pythonの辞書からDataFrameを作るには: <code>pd.DataFrame()</code></p>
        <p>特定の条件でデータを選ぶ（フィルタリング）には: <code>df[df['列名'] > 値]</code> のような形を使います。</p>
        <p>ある列で最大の値を持つ行を見つけるには: <code>df['列名'].idxmax()</code> でその行のインデックス（番号）がわかります。</p>
        <p>インデックスを使って特定の行のデータを表示するには: <code>df.loc[インデックス番号]</code></p>
      `
    },
    {
      id: 'kadai3',
      title: '課題3：Matplotlibでグラフを作ろう 📈📉',
      library: 'Matplotlib (マットプロットリブ)',
      description: 'Matplotlibは、データからいろいろな種類のグラフを作ることができるライブラリです。データを目で見てわかりやすくするのに役立ちます。',
      task_title: '課題：',
      task: 'あるお店の1週間の日ごとの売上データがあります。このデータを使って、折れ線グラフを作ってください。',
      data_description: 'データ：',
      data: `
* 曜日リスト: \`["月", "火", "水", "木", "金", "土", "日"]\`
* 売上リスト: \`[15, 17, 13, 18, 22, 25, 23]\` (単位: 万円)
      `,
      code_hint_title: 'ヒント：使うかもしれないMatplotlibの関数',
      code_hint_text: `
        <p>折れ線グラフを作る基本の関数: <code>plt.plot(x軸のデータ, y軸のデータ)</code></p>
        <p>x軸にラベルを付けるには: <code>plt.xlabel("ラベル名")</code></p>
        <p>y軸にラベルを付けるには: <code>plt.ylabel("ラベル名")</code></p>
        <p>グラフにタイトルを付けるには: <code>plt.title("タイトル名")</code></p>
        <p>グラフを表示するには: <code>plt.show()</code></p>
        <p>日本語が正しく表示されない場合は、フォントの設定が必要かもしれません。(例: <code>plt.rcParams['font.family'] = 'Meiryo'</code> など)</p>
      `,
      note: '**注意：** もしグラフの日本語が四角（□□□）のように表示されたら、お使いの環境に合わせて日本語フォントの設定が必要です。ヒントにあるようなフォント設定のコードを試してみてください。'
    },
    {
      id: 'kadai4',
      title: '課題4：RequestsとBeautiful Soupでウェブ情報取得 🌐🥣',
      library: 'Requests (リクエスト) と Beautiful Soup (ビューティフルスープ)',
      description: 'Requestsは、ウェブページにアクセスして情報を取ってくるライブラリです。Beautiful Soupは、取ってきたウェブページの情報（HTMLという言葉で書かれています）から、必要な部分だけを取り出すのが得意なライブラリです。',
      task_title: '課題：',
      task: '指定された簡単なHTMLのテキストから、ウェブページのタイトルと、リストにある項目をすべて取り出して表示してください。',
      data_description: 'データ（HTMLテキスト）：',
      data_code_lang: 'html',
      data: `
<html>
<head>
    <title>私の好きな食べ物</title>
</head>
<body>
    <h1>好きな食べ物リスト</h1>
    <ul>
        <li>寿司</li>
        <li>ラーメン</li>
        <li>カレーライス</li>
    </ul>
</body>
</html>`,
      code_hint_title: 'ヒント：使うかもしれないBeautiful Soupの機能',
      code_hint_text: `
        <p>HTMLテキストをBeautiful Soupオブジェクトにするには: <code>BeautifulSoup(html文字列, 'html.parser')</code></p>
        <p>特定のHTMLタグを見つける (最初の一つ): <code>soup.find('タグ名')</code> (例: <code>soup.find('title')</code>)</p>
        <p>特定のHTMLタグをすべて見つける (リストとして): <code>soup.find_all('タグ名')</code> (例: <code>soup.find_all('li')</code>)</p>
        <p>タグの中の文字列を取り出すには: <code>タグオブジェクト.string</code> や <code>タグオブジェクト.get_text()</code></p>
      `,
      note: '**注意：** 実際のウェブサイトから情報を取るときは、そのサイトのルール（robots.txtなど）を守りましょう。この課題では、用意されたテキストを使います。'
    },
    {
      id: 'kadai5',
      title: '課題5：Scikit-learnで簡単な機械学習を体験しよう 🤖💡',
      library: 'Scikit-learn (サイキットラーン)',
      description: 'Scikit-learnは、機械学習のためのたくさんの道具が入っているライブラリです。データの分類や予測などができます。',
      task_title: '課題：',
      task: 'アヤメという花の、がく片の長さ(sepal length)と幅(sepal width)のデータがあります。この2つの情報から、アヤメの種類を予測する簡単なモデルを作り、新しいデータがどの種類のアヤメに近いか予測させてみましょう。（この課題では、k-近傍法というシンプルな方法を使います。）',
      data_description: 'データ：',
      data: `
* **学習用データ（種類がわかっている花）：**
    * 特徴量 (X_train): \`[[5.1, 3.5], [4.9, 3.0], [7.0, 3.2], [6.4, 3.2]]\` (各要素は [がく片長さ, がく片幅])
    * ラベル (y_train): \`[0, 0, 1, 1]\` (0: 種類A, 1: 種類B)
* **予測したい新しい花：**
    * 特徴量 (new_flower_data): \`[[5.5, 3.1]]\`
      `,
      code_hint_title: 'ヒント：使うかもしれないScikit-learnのクラスとメソッド',
      code_hint_text: `
        <p>k-近傍法分類器の準備: <code>KNeighborsClassifier(n_neighbors=適切な数)</code> (例: <code>n_neighbors=3</code>)</p>
        <p>モデルを学習させる (訓練する): <code>モデルオブジェクト.fit(学習用の特徴量, 学習用のラベル)</code></p>
        <p>新しいデータで予測する: <code>モデルオブジェクト.predict(予測したいデータの特徴量)</code></p>
        <p>NumPyを使ってデータを配列の形にすると便利です: <code>np.array()</code></p>
      `
    }
];

const sidebarNav = document.getElementById('sidebar-nav');
const exerciseContentDiv = document.getElementById('exercise-content');
const sidebar = document.getElementById('sidebar');
const content = document.getElementById('content');
const menuToggle = document.getElementById('menu-toggle');

function renderWelcomeMessage() {
    exerciseContentDiv.innerHTML = `
        <div class="card">
            <h2 class="text-3xl font-semibold text-gray-800 mb-4">Pythonデータ処理の世界へようこそ！</h2>
            <p class="text-gray-600">このウェブサイトでは、Pythonの主要なデータ処理ライブラリ（NumPy, Pandas, Matplotlibなど）を使った実践的な課題に取り組むことができます。</p>
            <p class="text-gray-600 mt-2">左側のメニューから挑戦したい課題を選んでください。各課題ページには、詳しい説明、扱うデータ、そして解答のヒントが用意されています。</p>
            <p class="text-gray-600 mt-2">プログラミング学習の一助となれば幸いです。さあ、始めましょう！</p>
            <img src="https://placehold.co/600x300/e2e8f0/4a5568?text=Let's+Start+Learning+Python!" alt="Python学習開始のイメージ" class="mt-6 rounded-lg shadow-md mx-auto">
        </div>`;
    document.querySelectorAll('.sidebar-link').forEach(l => l.classList.remove('active'));
    location.hash = ''; // ウェルカムページの場合はハッシュをクリア
}

function renderSidebar() {
    exercises.forEach((exercise, index) => {
        const link = document.createElement('a');
        link.href = `#${exercise.id}`;
        const displayTitle = exercise.title.split('：')[1] || exercise.title;
        link.textContent = `課題 ${index + 1}: ${displayTitle.substring(0, displayTitle.indexOf(' ') !== -1 ? displayTitle.indexOf(' ') : displayTitle.length)}`;
        link.classList.add('sidebar-link');
        link.onclick = (event) => {
            event.preventDefault();
            renderExerciseContent(exercise.id);
            document.querySelectorAll('.sidebar-link').forEach(l => l.classList.remove('active'));
            link.classList.add('active');
            if (window.innerWidth < 768) {
                sidebar.classList.remove('active-sidebar');
                sidebar.classList.add('hidden-sidebar');
            }
        };
        sidebarNav.appendChild(link);
    });
}

function formatTextToHtml(text) {
    if (typeof text !== 'string') return '';
    text = text.replace(/^\* (.*$)/gm, '<li>$1</li>');
    text = text.replace(/<\/li>\n<li>/g, '</li><li>'); 
    if (text.includes('<li>')) {
        text = '<ul>' + text.replace(/<li>/g, '<li class="list-disc ml-5 mb-1">') + '</ul>';
    }
    if (!text.startsWith('<ul>')) {
       text = text.replace(/\n/g, '<br>');
    }
    return text;
}


function renderExerciseContent(exerciseId) {
    const exercise = exercises.find(ex => ex.id === exerciseId);
    if (!exercise) {
        // 課題が見つからない場合はウェルカムページを表示
        renderWelcomeMessage();
        return;
    }

    const escapeHtml = (unsafe) => {
        if (typeof unsafe !== 'string') return '';
        return unsafe
             .replace(/&/g, "&amp;")
             .replace(/</g, "&lt;")
             .replace(/>/g, "&gt;")
             .replace(/"/g, "&quot;")
             .replace(/'/g, "&#039;");
    }

    let dataHtml = '';
    if (exercise.data_code_lang) {
        dataHtml = `<pre class="code-block"><code>${escapeHtml(exercise.data.trim())}</code></pre>`;
    } else if (exercise.data.includes('`')) {
         dataHtml = `<div class="text-gray-700 mb-4 whitespace-pre-wrap">${exercise.data.replace(/`([^`]+)`/g, '<code class="bg-gray-200 text-gray-800 text-sm px-1 py-0.5 rounded">$1</code>').replace(/\n/g, '<br>')}</div>`;
    }
    else {
        dataHtml = `<div class="text-gray-700 mb-4 whitespace-pre-wrap">${formatTextToHtml(exercise.data.trim())}</div>`;
    }

    let hintHtml = '';
    if (exercise.code_hint_text) {
        hintHtml = `<div class="hint-block">${exercise.code_hint_text.trim()}</div>`;
    } else if (exercise.code_hint) { 
        hintHtml = `<pre class="code-block"><code>${escapeHtml(exercise.code_hint.trim())}</code></pre>`;
    }


    exerciseContentDiv.innerHTML = `
        <div class="card">
            <h2 class="text-3xl font-semibold text-gray-800 mb-2">${exercise.title}</h2>
            <p class="text-sm text-indigo-600 font-medium mb-4">${exercise.library}</p>
            
            <h3 class="text-xl font-semibold text-gray-700 mt-6 mb-2">ライブラリ説明</h3>
            <p class="text-gray-700 mb-4 whitespace-pre-wrap">${formatTextToHtml(exercise.description)}</p>

            <h3 class="text-xl font-semibold text-gray-700 mt-6 mb-2">${exercise.task_title}</h3>
            <div class="text-gray-700 mb-4 whitespace-pre-wrap">${formatTextToHtml(exercise.task)}</div>

            <h3 class="text-xl font-semibold text-gray-700 mt-6 mb-2">${exercise.data_description}</h3>
            ${dataHtml}

            ${exercise.note ? `<div class="mt-4 p-3 bg-yellow-100 border-l-4 border-yellow-500 text-yellow-700 rounded"><p class="whitespace-pre-wrap">${formatTextToHtml(exercise.note)}</p></div>` : ''}

            <h3 class="text-xl font-semibold text-gray-700 mt-6 mb-2">${exercise.code_hint_title}</h3>
            ${hintHtml}
        </div>
    `;
    window.scrollTo(0, 0);
    if (location.hash !== `#${exerciseId}`) {
        location.hash = exerciseId;
    }
}

document.addEventListener('DOMContentLoaded', () => {
    renderSidebar();

    const currentHash = window.location.hash.substring(1);
    const exerciseToLoad = exercises.find(ex => ex.id === currentHash);

    if (exerciseToLoad) {
        renderExerciseContent(exerciseToLoad.id);
        document.querySelectorAll('.sidebar-link').forEach(link => {
            if (link.getAttribute('href') === `#${exerciseToLoad.id}`) {
                link.classList.add('active');
            }
        });
    } else {
        // ハッシュがない、または無効なハッシュの場合、ウェルカムメッセージを表示
        renderWelcomeMessage();
    }
    
    menuToggle.addEventListener('click', () => {
        sidebar.classList.toggle('active-sidebar');
        sidebar.classList.toggle('hidden-sidebar');
    });

    content.addEventListener('click', () => {
        if (window.innerWidth < 768 && sidebar.classList.contains('active-sidebar')) {
            sidebar.classList.remove('active-sidebar');
            sidebar.classList.add('hidden-sidebar');
        }
    });

    window.addEventListener('hashchange', () => {
        const newHash = window.location.hash.substring(1);
        const newExerciseToLoad = exercises.find(ex => ex.id === newHash);
        if (newExerciseToLoad) {
            renderExerciseContent(newExerciseToLoad.id);
            document.querySelectorAll('.sidebar-link').forEach(link => {
                link.classList.remove('active'); // Remove active from all
                if (link.getAttribute('href') === `#${newExerciseToLoad.id}`) {
                    link.classList.add('active');
                }
            });
        } else {
            // 無効なハッシュになった場合、ウェルカムメッセージを表示
            renderWelcomeMessage();
        }
    });
});

</script>
</body>
</html>
